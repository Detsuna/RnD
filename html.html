<!DOCTYPE HTML>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <style>
        * {
            font-size: 40px;
        }

        html,
        body {
            width: 100%;
            height: 100%;
            padding: 0;
            margin: 0;
        }

        .block {
            border: 1px solid black;
        }
    </style>
    <script>
        "use strict";
        (function (app, undefined) {
            function Post(path, body = null) {
                return [{ id: 1, desc: "one" }, { id: 2, desc: "two" }, { id: 3, desc: "three" }]
                return fetch(`http://localhost/${path}`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: body
                }).then((response) => { return response.json(); });
            }
            function Select(input) {
                for (var i = 0; i < input.list.options.length; i++) {
                    if (input.value == input.list.options[i].textContent) {
                        input.selected = input.list.options[i];
                        break;
                    }
                }
                input.value = input.selected.textContent;
            }
            function FillList(input, data) {
                var option = document.createElement('option');
                option.textContent = "-- SELECT --";
                option.data = null;
                option.style.color = "grey";
                input.list.appendChild(option);
                input.selected = option;
                for (var i = 0; i < data.length; i++) {
                    option = document.createElement('option');
                    option.textContent = data[i].desc;
                    option.data = data[i].id;
                    input.list.appendChild(option);
                }
                input.addEventListener("change", function (event) { Select(input); });
                Select(input);
            }

            app.Store = {
                equip: null,
                svc: null,
                svcHist: null
            }
            app.Init = function () {
                return new Promise((resolve, reject) => {
                    app.Store.equip = document.getElementById("Equip");
                    app.Store.svc = document.getElementById("Svc");
                    app.Store.svcHist = document.getElementById("SvcHist");
                    resolve();
                }).then(() => {
                    return Post("GetEquip");
                }).then((data) => {
                    FillList(app.Store.equip, data);
                }).then((data) => {
                    app.Store.equip.addEventListener("blur", function (event) {
                        //setTimeout();
                    });
                });;
            }
            app.Bind = function () {
                return new Promise((resolve, reject) => {
                    resolve();
                }).then(() => {
                    return Post("GetEquip");
                }).then((data) => {
                    FillList(app.Store.equip, data);
                });
            }
            window.addEventListener("load", (event) => { app.Init(); });
        }(window.app = window.app || {}));
    </script>
</head>

<body>
    <div class="block">
        <label for="Equip">Equip:&nbsp;</label>
        <input id="Equip" list="EquipList">
        <datalist id="EquipList"></datalist>
    </div>
    <div class="block">
        <label for="Svc">Svc:&nbsp;</label>
        <input id="Svc" list="SvcList">
        <datalist id="SvcList"></datalist>
    </div>
    <div id="SvcHist" class="block"></div>
</body>

</html>